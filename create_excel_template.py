"""
Excelè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
12ç¥ã®è¨­å®šã€kè¡Œåˆ—ã€lè¡Œåˆ—ã‚’å«ã‚€Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™
"""

import pandas as pd
import numpy as np
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment

def create_excel_template(output_file: str = "12ç¥è¨­å®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ.xlsx"):
    """Excelè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆ"""
    
    # Workbookã‚’ä½œæˆ
    wb = Workbook()
    
    # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤
    wb.remove(wb.active)
    
    # ===== Sheet1: 12ç¥åŸºæœ¬æƒ…å ± =====
    ws_gods = wb.create_sheet("12ç¥åŸºæœ¬æƒ…å ±")
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
    headers = ["ID", "åå‰", "åå‰(è‹±èª)", "å±æ€§", "çµµæ–‡å­—", "èª¬æ˜", "æ ¼è¨€"]
    ws_gods.append(headers)
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
    header_fill = PatternFill(start_color="366092", end_color="366092", fill_type="solid")
    header_font = Font(bold=True, color="FFFFFF")
    for cell in ws_gods[1]:
        cell.fill = header_fill
        cell.font = header_font
        cell.alignment = Alignment(horizontal="center", vertical="center")
    
    # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆ12ç¥ï¼‰
    sample_gods = [
        [0, "ç§‹è‘‰ä¸‰å°ºåŠ", "Akiba Sanjakubo", "ç«", "ğŸ”¥", "ç§‹è‘‰åŸã®å®ˆè­·ç¥ã€‚ç«ä¼ã›=ã€Œç‚ä¸Šå›é¿ã€ã®ç¥ã€‚", "å‹¢ã„MAX: æƒ…ç†±çš„ãªç­†è‡´ã«é™è‡¨ã€‚"],
        [1, "çœŸç©ºç®¡å¤§å°†è»", "Vacuum Tube General", "é›»", "âš¡", "ç§‹è‘‰åŸã®åŸç‚¹ã€‚å¢—å¹…=ã€Œæ‰èƒ½é–‹èŠ±ã€ã®ç¥ã€‚", "ç·šã®å¤ªã•: åŠ›å¼·ãã€å¤ªã„ç·šã«åå¿œã€‚"],
        [2, "LEDå¼è²¡å¤©", "LED Benzaiten", "å…‰", "ğŸ’¡", "ã‚¤ãƒ«ãƒŸãƒãƒ¼ã‚·ãƒ§ãƒ³ã¨ç™ºå…‰ã€‚ã€Œè‡ªå·±è¡¨ç¾ã€ã®ç¥ã€‚", "ä¸¸ã¿: è¯ã‚„ã‹ã§æ›²ç·šçš„ãªç­†è·¡ã€‚"],
        [3, "ç£æ°—è¨˜éŒ²é»’é¾", "Magnetic Recording Black Dragon", "ç£", "ğŸ‰", "HDDã‚„ãƒ†ãƒ¼ãƒ—ã€‚è¨˜æ†¶=ã€Œæ¸©æ•…çŸ¥æ–°ã€ã®å®ˆè­·é¾ã€‚", "ç·»å¯†ã•: ç´°ã‹ãä¸å¯§ãªæ›¸ãè¾¼ã¿ã€‚"],
        [4, "ç„¡ç·šå‚å—è¦³éŸ³", "Wireless Interception Kannon", "æ³¢", "ğŸ“¡", "é›»æ³¢ã¨é€šä¿¡ã€‚ç¸çµã³=ã€Œãƒãƒƒãƒãƒ³ã‚°ã€ã®ç¥ã€‚", "ã‚†ã‚‰ã: éœ‡ãˆã‚„è¿·ã„ãŒã‚ã‚‹ç­†è·¡ã«å¯„ã‚Šæ·»ã†ã€‚"],
        [5, "åŸºæ¿æ›¼è¼ç¾…", "Circuit Board Mandala", "åŸº", "ğŸ”Œ", "å›è·¯è¨­è¨ˆã€‚ç§©åº=ã€Œè«–ç†çš„æ€è€ƒã€ã®ç¥ã€‚", "ç›´ç·šçš„: è¿·ã„ã®ãªã„ã€ã‚«ã‚¯ã‚«ã‚¯ã—ãŸç·šã€‚"],
        [6, "çµ¶å¯¾é›¶åº¦æ˜ç‹", "Absolute Zero Myo-o", "å†·", "â„ï¸", "å†·å´ãƒ•ã‚¡ãƒ³ãƒ»è¶…é›»å°ã€‚å†·é™=ã€Œæ²ˆç€å†·é™ã€ã®ç¥ã€‚", "ç­†åœ§å¼±ã‚: ã‚¯ãƒ¼ãƒ«ã§æ·¡ã€…ã¨ã—ãŸç­†è·¡ã€‚"],
        [7, "ã‚¸ãƒ£ãƒ³ã‚¯å†ç”Ÿç«¥å­", "Junk Regeneration Child", "å£Š", "ğŸ”§", "ç§‹è‘‰åŸã®ã‚¸ãƒ£ãƒ³ã‚¯å“ã€‚å¾©æ´»=ã€Œå†èµ·ãƒ»ãƒªãƒˆãƒ²ã€ã®ç¥ã€‚", "ã‹ã™ã‚Œ: è’ã€…ã—ã„ã€ã¾ãŸã¯æ ã‚ŒãŸç·šã€‚"],
        [8, "çœŸç©ºã‚ªãƒ¼ãƒ‡ã‚£ã‚ªå¦‚æ¥", "Vacuum Audio Nyorai", "éŸ³", "ğŸ§", "é«˜éŸ³è³ªãƒ»å…±é³´ã€‚ã€Œæœ¬è³ªã‚’è¦‹æ¥µã‚ã‚‹ã€ç¥ã€‚", "èª¿å’Œ: æ–‡å­—å…¨ä½“ã®ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„ã€‚"],
        [9, "ãƒãƒ³ãƒ€ä»˜ã‘çµã³ç¥", "Soldering Connection Deity", "çµ", "ğŸ”—", "æ¥ç‚¹ã¨çµåˆã€‚å”åŠ›=ã€Œãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€ã®ç¥ã€‚", "ãƒˆãƒ¡ãƒ»ãƒãƒ: ç¹‹ãéƒ¨åˆ†ãŒã—ã£ã‹ã‚Šã—ã¦ã„ã‚‹ã€‚"],
        [10, "å…‰é€Ÿé€šä¿¡éŸ‹é§„å¤©", "Light-speed Communication Idaten", "é€Ÿ", "ğŸš€", "5Gãƒ»å…‰å›ç·šã€‚çˆ†é€Ÿ=ã€Œå³æ–­å³æ±ºã€ã®ç¥ã€‚", "æ›¸ãé€Ÿåº¦: ã‚µãƒƒã¨çŸ­æ™‚é–“ã§æ›¸ã„ãŸç·šã€‚"],
        [11, "åŠå°ä½“æ–‡æ®Š", "Semiconductor Manjushri", "æ™º", "ğŸ§ ", "CPUãƒ»AIã€‚è¨ˆç®—=ã€Œåˆæ ¼ãƒ»çŸ¥ç•¥ã€ã®ç¥ã€‚", "è¦å‰‡æ€§: ç­‰é–“éš”ã§æ•´ç†ã•ã‚ŒãŸç­†è·¡ã€‚"],
    ]
    
    # ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
    for row in sample_gods:
        ws_gods.append(row)
    
    # åˆ—å¹…ã‚’èª¿æ•´
    ws_gods.column_dimensions['A'].width = 5
    ws_gods.column_dimensions['B'].width = 15
    ws_gods.column_dimensions['C'].width = 25
    ws_gods.column_dimensions['D'].width = 8
    ws_gods.column_dimensions['E'].width = 8
    ws_gods.column_dimensions['F'].width = 40
    ws_gods.column_dimensions['G'].width = 40
    
    # ===== Sheet2: kè¡Œåˆ—ï¼ˆ12x12ï¼šã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ Ã— èª“é¡˜ï¼‰ =====
    ws_k = wb.create_sheet("kè¡Œåˆ—")
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼ˆèª“é¡˜01ï½12ï¼‰
    k_headers = [""] + [f"èª“é¡˜{i:02d}" for i in range(1, 13)]
    ws_k.append(k_headers)
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
    for cell in ws_k[1]:
        cell.fill = header_fill
        cell.font = header_font
        cell.alignment = Alignment(horizontal="center", vertical="center")
    
    # è¡Œãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åï¼‰ã¨ãƒ‡ãƒ¼ã‚¿
    # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼šå„ç¥ã®èª“é¡˜å€¤ã‚’è¨­å®šï¼ˆç¾åœ¨ã®TWELVE_GODSã®å€¤ã‚’ä½¿ç”¨ï¼‰
    sample_k_matrix = [
        [-0.4, 0.2, -0.2, 0.0, 0.0, 0.0, 0.0, -0.4, 0.0, 0.0, 0.0, -0.2],  # ç§‹è‘‰ä¸‰å°ºåŠ
        [-0.2, 0.2, 0.0, -0.4, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4],  # çœŸç©ºç®¡å¤§å°†è»
        [0.0, 0.2, 0.0, -0.4, 0.0, 0.0, 0.0, 0.0, -0.4, 0.0, -0.2, -0.2],  # LEDå¼è²¡å¤©
        [0.0, 0.0, -0.4, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.2],  # ç£æ°—è¨˜éŒ²é»’é¾
        [-0.4, 0.2, 0.0, -0.2, -0.4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2],  # ç„¡ç·šå‚å—è¦³éŸ³
        [0.0, -0.2, 0.0, 0.0, 0.0, -0.4, -0.4, 0.0, 0.2, -0.2, 0.0, 0.0],  # åŸºæ¿æ›¼è¼ç¾…
        [0.0, -0.4, -0.2, 0.0, 0.0, 0.0, -0.4, 0.0, 0.0, 0.0, -0.2, 0.2],  # çµ¶å¯¾é›¶åº¦æ˜ç‹
        [-0.2, 0.0, 0.0, -0.2, 0.0, 0.0, 0.2, -0.4, 0.0, 0.0, 0.0, -0.4],  # ã‚¸ãƒ£ãƒ³ã‚¯å†ç”Ÿç«¥å­
        [0.0, 0.0, 0.0, -0.2, -0.4, 0.0, 0.2, 0.0, -0.2, 0.0, -0.4, 0.0],  # çœŸç©ºã‚ªãƒ¼ãƒ‡ã‚£ã‚ªå¦‚æ¥
        [0.0, -0.4, -0.2, 0.0, -0.4, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.2],  # ãƒãƒ³ãƒ€ä»˜ã‘çµã³ç¥
        [0.0, 0.2, 0.0, -0.2, -0.4, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, -0.4],  # å…‰é€Ÿé€šä¿¡éŸ‹é§„å¤©
        [0.0, 0.0, -0.2, 0.0, 0.0, -0.4, -0.2, 0.0, 0.0, -0.4, 0.0, 0.2],  # åŠå°ä½“æ–‡æ®Š
    ]
    
    # ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
    for i, (god_name, k_row) in enumerate(zip([god[1] for god in sample_gods], sample_k_matrix)):
        row_data = [god_name] + k_row
        ws_k.append(row_data)
    
    # åˆ—å¹…ã‚’èª¿æ•´
    ws_k.column_dimensions['A'].width = 20
    for col in range(2, 14):
        ws_k.column_dimensions[chr(64 + col)].width = 10
    
    # ===== Sheet3: lè¡Œåˆ—ï¼ˆ12x4ï¼šã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ Ã— ä¸–ç•Œè¦³è»¸ï¼‰ =====
    ws_l = wb.create_sheet("lè¡Œåˆ—")
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œï¼ˆstillness, flow, ma, sincerityï¼‰
    l_headers = [""] + ["stillness", "flow", "ma", "sincerity"]
    ws_l.append(l_headers)
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
    for cell in ws_l[1]:
        cell.fill = header_fill
        cell.font = header_font
        cell.alignment = Alignment(horizontal="center", vertical="center")
    
    # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼šå„ç¥ã®å½¹å‰²å±æ€§ã‚’è¨­å®šï¼ˆç¾åœ¨ã®TWELVE_GODSã®å€¤ã‚’ä½¿ç”¨ï¼‰
    sample_l_matrix = [
        [0.0, -0.2, 0.0, -0.4],  # ç§‹è‘‰ä¸‰å°ºåŠ
        [0.0, -0.4, 0.0, -0.2],  # çœŸç©ºç®¡å¤§å°†è»
        [0.0, -0.4, -0.2, 0.0],  # LEDå¼è²¡å¤©
        [-0.2, 0.0, 0.0, -0.4],  # ç£æ°—è¨˜éŒ²é»’é¾
        [0.0, -0.4, -0.2, 0.0],  # ç„¡ç·šå‚å—è¦³éŸ³
        [-0.4, 0.0, 0.0, -0.2],  # åŸºæ¿æ›¼è¼ç¾…
        [-0.4, 0.0, -0.2, 0.0],  # çµ¶å¯¾é›¶åº¦æ˜ç‹
        [0.0, -0.4, 0.0, -0.2],  # ã‚¸ãƒ£ãƒ³ã‚¯å†ç”Ÿç«¥å­
        [0.0, -0.4, -0.2, 0.0],  # çœŸç©ºã‚ªãƒ¼ãƒ‡ã‚£ã‚ªå¦‚æ¥
        [-0.2, 0.0, -0.4, 0.0],  # ãƒãƒ³ãƒ€ä»˜ã‘çµã³ç¥
        [0.0, -0.4, 0.0, -0.2],  # å…‰é€Ÿé€šä¿¡éŸ‹é§„å¤©
        [-0.4, 0.0, 0.0, -0.2],  # åŠå°ä½“æ–‡æ®Š
    ]
    
    # ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
    for i, (god_name, l_row) in enumerate(zip([god[1] for god in sample_gods], sample_l_matrix)):
        row_data = [god_name] + l_row
        ws_l.append(row_data)
    
    # åˆ—å¹…ã‚’èª¿æ•´
    ws_l.column_dimensions['A'].width = 20
    for col in range(2, 6):
        ws_l.column_dimensions[chr(64 + col)].width = 12
    
    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜
    wb.save(output_file)
    print(f"âœ… Excelãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ: {output_file}")

if __name__ == "__main__":
    create_excel_template()