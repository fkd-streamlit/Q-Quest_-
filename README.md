# Q-Quest 量子神託 (Quantum Oracle)

> Human-Centric Quantum Philosophy  
> 人と人とをつなぐ"縁"が量子技術が創造する

## プロジェクト概要

**Q-Quest 量子神託**は、QUBO（Quadratic Unconstrained Binary Optimization）技術を用いて、日本の伝統的な「縁」の概念を量子技術で表現した価値体験プロジェクトです。

### ビジョン

- **Human-Centric Quantum Philosophy**という新しい潮流を、日本から世界へ発信
- 人と人とをつなぐ"縁"を量子技術が創造する
- 文化の懸け橋となり、次世代に向けた価値体験を提供
- 日本の文化を見直し、世界に向けて発信
- 海外の方が逆に日本を魅力と感じるポイントをしっかり見直して、活かす

## コンセプト

### 量子神託（Quantum Oracle）

従来の「おみくじ」を現代的な量子技術で再解釈。ユーザーの「心の傾き」を分析し、QUBOアルゴリズムを通じて最適な「縁」を提示します。

### 核心的な要素

1. **縁（En）の量子化**: 人と人、人と場所、人と体験の「縁」をQUBOモデルで表現
2. **心の傾き（Mood）の推定**: テキスト入力から感情状態を推定し、QUBOパラメータを動的に調整
3. **量子おみくじ**: ボルツマン分布を用いた確率的な「神託」提示
4. **日本の文化要素**: 季節、俳句、禅的な言葉を用いた体験設計

## 技術スタック

- Python 3.x
- NumPy（数値計算）
- Matplotlib（可視化）
- Jupyter Notebook（実験・プロトタイプ）
- **Streamlit（Webアプリケーション）** ⭐NEW
- **Plotly（インタラクティブ3D可視化）** ⭐NEW
- **Pandas + OpenPyXL（Excel設定ファイル読み込み）** ⭐NEW
- **Optuna（QUBO最適化の可視化）** ⭐NEW

## プロジェクト構造

```
Q-Quest_量子神託/
├── README.md                 # このファイル
├── app.py                     # Streamlitアプリ（メイン）
├── Q_QUEST_量子神託.ipynb    # メインのJupyter Notebook
├── requirements.txt          # 依存パッケージ
├── setup_notebook.py         # Notebookコピー用スクリプト（オプション）
├── QUICK_START.md            # クイックスタートガイド
├── CONTRIBUTING.md           # 貢献ガイドライン
├── assets/                   # 画像・リソースファイル
│   └── images/
│       └── characters/       # 12神のキャラクター画像（.png）
│           ├── README.md     # 画像配置ガイド
│           ├── character_01.png
│           ├── character_02.png
│           └── ... (character_12.png)
├── config/                   # Excel設定ファイル（ローカル開発用）
│   ├── README.md
│   └── 設定ファイルの配置方法.md
└── docs/                     # ドキュメント
    ├── README.md             # ドキュメント一覧と活用方法
    ├── PROJECT_VISION.md     # プロジェクトビジョン
    ├── CULTURAL_ELEMENTS.md  # 文化的要素の説明
    ├── DEVELOPMENT_ROADMAP.md # 開発ロードマップ
    └── README_EN.md          # 英語版README
```

## クイックスタート

### 方法1: Streamlitアプリで実行（推奨）⭐

**最も簡単な方法：**

1. **バッチファイルで起動**
   ```bash
   # Windowsの場合
   start_app.bat をダブルクリック
   ```

2. **または、コマンドで起動**
   ```bash
   # 依存パッケージのインストール（初回のみ）
   pip install -r requirements.txt
   
   # Streamlitアプリを起動
   streamlit run app.py
   ```

3. **ブラウザが自動的に開きます**（通常は `http://localhost:8501`）

**機能：**
- ✅ 対話型量子神託：願い事を入力して神託を受ける
- ✅ 絵馬納め：願いを絵馬に書いて納める
- ✅ 言葉のエネルギー球体視覚化：3Dでキーワードを可視化
- ✅ Excel設定ファイルの読み込み：k行列とl行列をチューニング可能

### 方法2: Jupyter Notebookで実行

**必要な環境：**
- Python 3.8以上
- Jupyter Notebook

**セットアップ：**
```bash
# 依存パッケージのインストール
pip install -r requirements.txt

# Jupyter Notebookの起動
jupyter notebook Q_QUEST_量子神託.ipynb
```

### 方法3: GitHub + Streamlit Cloudで共有（チーム向け）⭐

**完全無料でアプリを共有：**

1. **GitHubリポジトリを作成**
   - [GitHub](https://github.com) でリポジトリを作成

2. **コードをプッシュ**
   ```bash
   # 自動スクリプトを使用（推奨）
   deploy_to_github.bat をダブルクリック
   
   # または手動で実行
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/あなたのユーザー名/リポジトリ名.git
   git push -u origin main
   ```

3. **Streamlit Cloudでデプロイ**
   - [Streamlit Cloud](https://streamlit.io/cloud) にアクセス
   - 「Sign in」→「New app」をクリック
   - リポジトリを選択、Branch: `main`、Main file: `app.py`
   - 「Deploy」をクリック

**詳細は `デプロイ手順_簡易版.md` を参照してください。**

## 機能

### Streamlitアプリ（`app.py`）⭐NEW

**4つの実行モード：**

1. **基本デモ**: QUBOモデルの基本動作を確認
2. **対話型量子神託**: 願い事を入力して、パーソナライズされた神託を受ける
3. **言葉のエネルギー球体視覚化**: 入力したキーワードを3D球体で可視化
4. **絵馬納め**: 願いを絵馬に書いて納めると、12神のうち適切な神が現れて神託を授ける

**Excel設定ファイルの読み込み機能：**
- k行列（12x12：キャラクター × 誓願）とl行列（12x4：キャラクター × 世界観軸）をExcelから読み込み
- 12神の設定をExcelでチューニング可能
- 詳細は `EXCEL_SETUP_GUIDE.md` を参照

**キャラクター画像の表示：**
- 12神のキャラクター画像（.png）を `assets/images/characters/` フォルダーに配置
- 画像ファイルの命名規則: `character_01.png` ～ `character_12.png`
- Excelファイルの順序に合わせて画像を配置（1行目 → character_01.png）
- 詳細は `CHARACTER_IMAGES_GUIDE.md` を参照

### Jupyter Notebook（`Q_QUEST_量子神託.ipynb`）

Notebookには4つの主要なCellがあります：

### 1. 基本デモ（Cell 0: QUBO × 縁：最小デモ）

基本的なQUBOモデルを使用した「縁」のデモンストレーション：

- **変数定義**: 4つの選択肢（人Aと話す、神社へ行く、茶の体験に入る、遠回りする）
- **QUBOモデリング**: 線形項と相互作用項による「縁の糸」の表現
- **全探索**: 2^4=16通りの組み合わせを評価
- **エネルギー地形の可視化**: 低エネルギーほど「縁が結ばれやすい候補」を表示
- **縁のネットワーク表示**: 選択肢同士の相互作用をグラフで可視化
- **量子おみくじ**: ボルツマン分布を用いた確率的な「神託」生成

### 2. 対話型量子神託（Cell 2: 悩み入力 → QUBO生成 → 候補提示 → おみくじ）

ユーザーの感情状態に基づいてQUBOパラメータを動的に調整する対話型機能：

- **テキスト入力**: ユーザーの悩み・気持ちを一文で入力
- **心の傾き（Mood）の推定**: 
  - 疲れ（fatigue）
  - 不安・焦り（anxiety）
  - 好奇心（curiosity）
  - 孤独感（loneliness）
  - 決断力（decisiveness）
- **QUBOパラメータの動的調整**: Moodに基づいて「縁の地形」を調整
- **候補提示**: 低エネルギー上位3つを表示
- **パーソナライズされた量子おみくじ**: 
  - Moodに基づいた温度（T）パラメータで「揺らぎ」を制御
  - 季節（季語）と禅的な言葉を含む神託カードを生成
  - エネルギー地形の可視化

### 3. 「整い」のQUBO設計（Cell 3: アート的視覚化）

内的状態のみを扱う「整い」を定義するQUBO設計：

- **内的状態の変数**: 迷い、焦り、静けさ、好奇心（人、行動、判断は一切出さない）
- **最適化しないQUBO**: 
  - 最小エネルギー解を探さない
  - エネルギー勾配を「感じさせる」
  - 解が定まらない状態を維持
- **整流の構造**:
  - 迷い × 焦り → ペナルティ（内的摩擦）
  - 静けさ × 迷い/焦り → 報酬（整流）
- **アート的視覚化**:
  - 黒〜濃紺の背景に単語が浮かぶ
  - QUBOエネルギーに基づいて単語が近づいたり離れたり
  - エッジ（線）が生まれて消える
  - 擬似脈拍による揺らぎ
- **先人の言葉**: エネルギー勾配が一定以下になった瞬間、禅的な言葉が出現（数秒で消える）

### 4. QUBO × 量子神託 UI（Cell 4: 言葉のエネルギーで繋がる球体視覚化）

入力した言葉を中心に、QUBOエネルギーで関連する言葉が繋がる3D球体視覚化：

- **ユーザー入力**: 願いや問いをテキストで入力
- **キーワード抽出**: 入力テキストから重要なキーワードを自動抽出
- **QUBOエネルギー計算**: キーワード間のエネルギー（類似度）を計算
- **3D球体配置**: 
  - 入力した重要なワードを中心に配置（金色で強調）
  - グローバルな単語データベースから、エネルギーが近い言葉を選択
  - 球体上に均等に散らばって配置
- **ネットワーク可視化**:
  - エネルギーが近い言葉同士を線で繋ぐ
  - エネルギーが低い（近い）ほど、線が明るく太く表示
- **格言の提示**: 入力したキーワードに基づいて、適切な有名な格言を表示

## 文化的背景

### 日本の魅力ポイント

1. **「縁」の概念**: 人と人との見えないつながりを大切にする文化
2. **おみくじの伝統**: 神社で運勢を占う習慣
3. **季節感（季語）**: 俳句などにみられる季節への敏感さ
4. **間（Ma）の美学**: 「余白」や「遠回り」を価値とする考え方
5. **禅的な言葉**: 「決めなくてよい。保留は、立派な選択である。」

### 世界への発信

これらの要素を量子技術という現代的な手法で表現することで、日本の文化的価値を新しい形で世界に伝えます。

## 使い方

### 🌐 Streamlitアプリ（推奨）

最も簡単に体験する方法です：

```bash
# 依存パッケージのインストール
pip install -r requirements.txt

# Streamlitアプリを起動
streamlit run app.py
```

ブラウザが自動的に開き、インタラクティブなWebアプリが表示されます。

**機能**：
- ✅ 基本デモ
- ✅ 対話型量子神託
- ✅ 言葉のエネルギー球体視覚化（3D、回転・ズーム可能）
- ✅ **絵馬納め**（秋葉三尺坊大権現が現れて神託を授ける）⭐NEW

**GitHubで公開する場合**：
1. コードをGitHubにプッシュ
2. [Streamlit Cloud](https://streamlit.io/cloud)でデプロイ（**完全無料**）
3. URLを共有するだけで誰でもアクセス可能！

詳細な手順は `GITHUB_DEPLOY.md` を参照してください。

詳細は `STREAMLIT_GUIDE.md` を参照してください。

### 📓 Jupyter Notebook

詳細な使い方は `QUICK_START.md` を参照してください。

### Cell 0の実行
1. Cell 0を選択
2. Shift+Enterで実行
3. エネルギー地形と縁のネットワークが表示され、量子おみくじが生成されます

### Cell 2の実行
1. Cell 2を選択
2. Shift+Enterで実行
3. プロンプトが表示されたら、悩みや気持ちを入力（例：「疲れていて決断ができない」「眠い。休みたい。」）
4. 心の傾きの推定結果、候補、量子おみくじが表示されます

### Cell 3の実行（「整い」の視覚化）
1. Cell 3を選択
2. Shift+Enterで実行
3. アニメーションが開始されます
4. 単語がゆっくり動き、エネルギー勾配が緩やかになったときに先人の言葉が現れます
5. 最適解に収束せず、常に揺らいでいる状態を観察してください

### Cell 4の実行（QUBO × 量子神託 UI）
1. Cell 4を選択
2. Shift+Enterで実行
3. プロンプトが表示されたら、願いや問いを入力（例：「世界平和に貢献できる人間になる」）
4. 3D球体が表示され、入力したキーワード（金色）を中心に、関連する言葉が線で繋がれます
5. 画面下部に適切な格言が表示されます

## 詳細情報

- **プロジェクトビジョン**: `docs/PROJECT_VISION.md`
- **文化的背景**: `docs/CULTURAL_ELEMENTS.md`
- **開発ロードマップ**: `docs/DEVELOPMENT_ROADMAP.md`
- **貢献方法**: `CONTRIBUTING.md`
- **キャラクター画像の配置**: `CHARACTER_IMAGES_GUIDE.md` ⭐NEW

## 技術的な詳細

### QUBOモデル

エネルギー関数: `E(x) = Σ Qii*xi + Σ Qij*xi*xj (i<j)`

- **線形項（Qii）**: 各選択の「傾き」（負の値=その選択を「招く」）
- **相互作用項（Qij）**: 選択同士の「縁の糸」（負の値=相乗効果、正の値=抑制）

### Mood推定

テキストからキーワードを抽出し、5つの感情次元を0〜1で推定します。

### 量子おみくじ

ボルツマン分布 `P(x) ∝ exp(-E(x)/T)` を使用して、低エネルギー状態から確率的に選択します。
- T（温度）が小さいほど最小エネルギー寄り
- Tが大きいほど「偶然性」が増える

## 貢献

このプロジェクトへの貢献を歓迎します。詳細は `CONTRIBUTING.md` を参照してください。

---

**Q-Quest 量子神託** - Connecting People Through Quantum-Enhanced Destiny


